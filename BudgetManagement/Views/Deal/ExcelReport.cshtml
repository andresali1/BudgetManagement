@{
    ViewData["Title"] = "Reporte Excel";
    var today = DateTime.Today;
    var aMonthAgo = today.AddMonths(-1);
    var currentMonth = today.Month;
    var currentYear = today.Year;
    var previousMonth = aMonthAgo.Month;
    var previousMonthYear = aMonthAgo.Year;
    var previousYear = currentYear - 1;
}

<partial name="_SubMenu" model="DealSubMenu.Excel" />

<h1>Exportar Transacciones a Excel</h1>

<div class="mb-3">
    <a asp-action="ExportExcelByMonth" asp-route-month="@currentMonth" asp-route-year="@currentYear"
       class="btn btn-success">
        Exportar mes actual
    </a>
    ~ @today.ToString("MMMM yyyy")
</div>

<div class="mb-3">
    <a asp-action="ExportExcelByMonth" asp-route-month="@previousMonth" asp-route-year="@previousMonthYear"
       class="btn btn-success">
        Exportar mes anterior
    </a>
    ~ @aMonthAgo.ToString("MMMM yyyy")
</div>

<div class="mb-3">
    <a asp-action="ExportExcelByYear" asp-route-year="@currentYear" class="btn btn-success">
        Exportar año actual
    </a>
    ~ @currentYear
</div>

<div class="mb-3">
    <a asp-action="ExportExcelByYear" asp-route-year="@previousYear" class="btn btn-success">
        Exportar año anterior
    </a>
    ~ @previousYear
</div>

<div class="mb-3">
    <a asp-action="ExportExcelAll" class="btn btn-success">
        Exportar todo
    </a>
</div>